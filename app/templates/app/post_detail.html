<!-- {% extends 'app/base.html' %}

{% block content %}

<h1>{{object.title}}</h1>
<img src="{{ object.image.url }}" alt="">
<p>{{object.content}}</p>
<form action="" method="POST">
    {% csrf_token %} 
    {{ form.as_p }}
    <button type="submit">Comment</button>
</form>

{% for comment in object.comments %} 
<p>commented by {{ user }}</p>
{{ comment.content }}
<hr>
{% endfor %} 

<form action="{% url 'app:like' object.slug %}" method="POST">
    {% csrf_token %}
    <input type="hidden", name="post">
    <input type="hidden", name="user">
    <button type="submit">Like</button> {{ object.like_count }}

</form>
<br>
{% if user.id == object.author.id %} 
<a href="{% url 'app:update' object.slug %}">Update</a>
<a href="{% url 'app:delete' object.slug %}">Delete</a>
{% endif %}

{% endblock content %} -->

{% load crispy_forms_tags %} 

<div class="card mb-3">
    <img src="{{ object.image.url }}" class="card-image-top" alt="post_image">
    <div class="card-body">
        <h2 class="card-title">{{ object.title }}</h2>
        <hr>
        <div>
            <span><i class="far fa-comment-alt ml-2"></i> {{ object.comment_count }}
            </span>
            <span><i class="fas fa-eye ml-2"></i> {{ object.view_count }}</span>
            <span><i class="far fa-heart ml-2"></i> {{ object.like_count }}</span>
            <span class="float-right"><small>Posted {{ object.publish_date|timesince }} ago.</small></span>
        </div>
        <hr>
        <div>
            <h4>Enjoy this post? Give it a LIKE!!</h4>
        </div>

        <div>
            <form action="{% url 'app:like' object.slug %}" method="POST">

                {% csrf_token %} 
                <input type="hidden" name="post">
                <input type="hidden" name="user">

                <button type="submit"><i class="far fa-heart fa-lg"></i></button>
                {{ object.like_count }}
            </form>
            <hr>
            <!-- {% if user.is_authenticated %} -->
            <h4>Leave a comment below</h4>
            <form action="" method="POST">
                {% csrf_token %} 
                {{ form|crispy }}
                <button class="btn btn-secondary btn-sm mt-1 mb-1">SEND</button>
            </form>
            <hr>
            <h4>Comments</h4> 
            {% for comment in object.comments %} 
            <div>
                <p>
                    <small><b>Comment by {{user.username}}</b></small> - <small>
                        {{ comment.time_stamp|timesince }} ago.
                    </small>
                </p>
                <p>
                    {{ comment.content }}
                </p>
            </div>
            <hr>
            {% endfor %} 
            <!-- {% else %}  -->
            <!-- <a href="#" class="btn btn-primary btn-block">Login to comment</a> -->
            <!-- {% endif %} -->
        </div>

    </div>

    <div class="m-3">
        {% if user.id == object.author.id %}
        <a href="{% url 'app:update' object.slug %}" class="btn btn-info">Edit</a>
        <a href="{% url 'app:delete' object.slug %}" class="btn btn-danger">Delete</a>
        {% endif %}
    </div>
    
</div>
